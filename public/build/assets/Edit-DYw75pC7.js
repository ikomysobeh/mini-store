import{d as I,j as P,r as j,c as F,a as k,b as r,g as o,e as a,u as t,k as L,f as n,t as c,i as p,o as u,h as C,n as U,m as A,v as M,l as x}from"./app-CpQjUiSo.js";import{c as N,b as m,_ as g,a as f}from"./index-B-I_JJ0o.js";import{_ as S}from"./Input.vue_vue_type_script_setup_true_lang-CpooQczP.js";import{_ as v}from"./Label.vue_vue_type_script_setup_true_lang-DD5-dmce.js";import{a as b,_}from"./CardTitle.vue_vue_type_script_setup_true_lang-OgblYUT6.js";import{_ as z}from"./Separator.vue_vue_type_script_setup_true_lang-Dyz0sWhy.js";import{_ as O}from"./AdminLayout.vue_vue_type_script_setup_true_lang-D6xVJ9P7.js";import{A as q}from"./arrow-left-BH73xRkf.js";import{E as T}from"./eye-BkcwXD3q.js";import{S as H}from"./save-D_dec0YK.js";import{T as J}from"./trash-2-neRDHJjC.js";import{I as D}from"./info-d5n8gkcO.js";import"./useForwardExpose-CJgl1R84.js";import"./heart-CvwJWGaj.js";import"./chevron-down-CilPvFWw.js";import"./search-D6-U2zSq.js";import"./house-p2pXnBDu.js";import"./package-BfAYm9nT.js";import"./users-Dr-iBOLK.js";import"./chevron-right-DyG-kt0V.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=N("FolderPenIcon",[["path",{d:"M2 11.5V5a2 2 0 0 1 2-2h3.9c.7 0 1.3.3 1.7.9l.8 1.2c.4.6 1 .9 1.7.9H20a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-9.5",key:"a8xqs0"}],["path",{d:"M11.378 13.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1saktj"}]]),Y={class:"min-h-screen bg-background text-foreground"},G={class:"border-b bg-card"},K={class:"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8"},Q={class:"flex items-center justify-between h-16"},W={class:"flex items-center space-x-4"},X={class:"flex items-center space-x-3"},Z={class:"p-2 bg-primary/10 rounded-lg"},ee={class:"flex items-center space-x-3"},te={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},se={class:"flex items-center space-x-2"},oe={class:"flex items-center space-x-2"},ae={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},re={class:"lg:col-span-2 space-y-8"},ie={class:"space-y-2"},le={key:0,class:"text-sm text-destructive"},ne={class:"space-y-2"},de={class:"flex"},ce={class:"text-xs text-muted-foreground"},ue={key:0,class:"text-sm text-destructive"},me={class:"space-y-2"},ge={class:"text-xs text-muted-foreground"},fe={class:"lg:col-span-1 space-y-6"},pe={class:"flex items-center space-x-2"},ve=["checked"],ye={key:0,class:"p-3 bg-orange-50 border border-orange-200 rounded-lg"},xe={class:"flex items-start space-x-2"},be={class:"space-y-2"},_e={class:"space-y-3 text-sm"},he={class:"flex justify-between"},we={class:"font-medium"},ke={class:"flex justify-between"},Ce={class:"flex justify-between"},Se={class:"flex justify-between"},De={class:"space-y-2"},Ye=I({__name:"Edit",props:{category:{type:Object,required:!0}},setup(i){const s=P({name:i.category.name||"",slug:i.category.slug||"",description:i.category.description||"",image:null,is_active:i.category.is_active!==void 0?!!i.category.is_active:!0,sort_order:i.category.sort_order||0,remove_image:!1,_method:"PUT"});j(i.category.image||null),i.category.image;const V=F(()=>s.name&&s.name.trim().length>0),h=F(()=>s.name!==i.category.name||s.slug!==i.category.slug||s.description!==(i.category.description||"")||s.is_active!==!!i.category.is_active||s.sort_order!==(i.category.sort_order||0)||s.image!==null||s.remove_image===!0),y=d=>d?d.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"):"",B=()=>{s.name&&!s.slug&&(s.slug=y(s.name))},$=(d=!1)=>{if(console.log("=== Form Submission Debug ==="),console.log("Form is_active before submission:",s.is_active,typeof s.is_active),console.log("Draft mode:",d),!V.value){alert("Category name is required");return}!s.slug&&s.name&&(s.slug=y(s.name));const e=s.is_active;if(d&&(s.is_active=!1),console.log("Form data before submission:",s.data()),s.image){const l=new FormData;l.append("name",s.name),l.append("slug",s.slug||""),l.append("description",s.description||""),l.append("sort_order",s.sort_order.toString()),l.append("is_active",s.is_active?"1":"0"),l.append("remove_image",s.remove_image?"1":"0"),l.append("image",s.image),l.append("_method","PUT"),console.log("Submitting FormData with is_active:",s.is_active?"1":"0"),x.post(`/admin/categories/${i.category.id}`,l,{forceFormData:!0,onSuccess:()=>{console.log("Update successful")},onError:w=>{console.error("Form submission errors:",w),s.is_active=e},onFinish:()=>{d&&(s.is_active=e)}})}else{const l={name:s.name,slug:s.slug||"",description:s.description||"",sort_order:parseInt(s.sort_order.toString())||0,is_active:!!s.is_active,remove_image:!!s.remove_image};console.log("Submitting JSON data:",l),x.put(`/admin/categories/${i.category.id}`,l,{onSuccess:()=>{console.log("Update successful")},onError:w=>{console.error("Form submission errors:",w),s.is_active=e},onFinish:()=>{d&&(s.is_active=e)}})}},E=()=>{const d=i.category.products_count>0;let e=`Are you sure you want to delete "${i.category.name}"?`;d&&(e+=`

This category has ${i.category.products_count} product(s). They will become uncategorized.`),e+=`

This action cannot be undone.`,confirm(e)&&x.delete(`/admin/categories/${i.category.id}`,{onSuccess:()=>{x.visit("/admin/categories")}})};return(d,e)=>(u(),k(O,{title:"Orders Management",breadcrumbs:d.breadcrumbs},{default:r(()=>[o("div",Y,[a(t(L),{title:`Edit ${i.category.name}`},null,8,["title"]),o("div",G,[o("div",K,[o("div",Q,[o("div",W,[a(t(m),{variant:"ghost",as:"a",href:"/admin/categories",class:"p-2"},{default:r(()=>[a(t(q),{class:"h-5 w-5"})]),_:1}),o("div",X,[o("div",Z,[a(t(R),{class:"h-6 w-6 text-primary"})]),e[7]||(e[7]=o("div",null,[o("h1",{class:"text-2xl font-bold text-foreground"},"Edit Category"),o("p",{class:"text-sm text-muted-foreground"}," Update category information ")],-1))])]),o("div",ee,[a(t(m),{variant:"outline",as:"a",href:`/products?category=${i.category.slug}`,target:"_blank"},{default:r(()=>[a(t(T),{class:"h-4 w-4 mr-2"}),e[8]||(e[8]=n(" View Category ",-1))]),_:1},8,["href"]),a(t(m),{variant:"outline",onClick:e[0]||(e[0]=l=>$(!0)),disabled:t(s).processing||!h.value},{default:r(()=>[...e[9]||(e[9]=[n(" Save as Draft ",-1)])]),_:1},8,["disabled"]),a(t(m),{onClick:e[1]||(e[1]=l=>$(!1)),disabled:t(s).processing||!V.value||!h.value},{default:r(()=>[a(t(H),{class:"h-4 w-4 mr-2"}),n(" "+c(t(s).processing?"Updating...":"Update Category"),1)]),_:1},8,["disabled"]),a(t(m),{variant:"destructive",onClick:E},{default:r(()=>[a(t(J),{class:"h-4 w-4 mr-2"}),e[10]||(e[10]=n(" Delete ",-1))]),_:1})])])])]),o("div",te,[i.category.is_active?p("",!0):(u(),k(t(g),{key:0,class:"mb-6 bg-destructive/20 border-destructive/50"},{default:r(()=>[a(t(f),{class:"p-4"},{default:r(()=>[o("div",se,[a(t(D),{class:"h-4 w-4 text-destructive"}),e[11]||(e[11]=o("p",{class:"text-sm text-destructive font-medium"}," This category is currently inactive and not visible to customers. ",-1))])]),_:1})]),_:1})),h.value?(u(),k(t(g),{key:1,class:"mb-6 bg-primary/10 border-primary/20"},{default:r(()=>[a(t(f),{class:"p-4"},{default:r(()=>[o("div",oe,[a(t(D),{class:"h-4 w-4 text-primary"}),e[12]||(e[12]=o("p",{class:"text-sm text-primary font-medium"}," You have unsaved changes. Don't forget to update the category. ",-1))])]),_:1})]),_:1})):p("",!0),o("div",ae,[o("div",re,[a(t(g),null,{default:r(()=>[a(t(b),null,{default:r(()=>[a(t(_),null,{default:r(()=>[...e[13]||(e[13]=[n("Basic Information",-1)])]),_:1})]),_:1}),a(t(f),{class:"space-y-6"},{default:r(()=>[o("div",ie,[a(t(v),{for:"name"},{default:r(()=>[...e[14]||(e[14]=[n(" Category Name ",-1),o("span",{class:"text-destructive"},"*",-1)])]),_:1}),a(t(S),{id:"name",modelValue:t(s).name,"onUpdate:modelValue":e[2]||(e[2]=l=>t(s).name=l),onInput:B,placeholder:"Electronics, Clothing, Books...",class:U(["text-lg",{"border-destructive":t(s).errors.name}])},null,8,["modelValue","class"]),t(s).errors.name?(u(),C("p",le,c(t(s).errors.name),1)):p("",!0)]),o("div",ne,[a(t(v),{for:"slug"},{default:r(()=>[...e[15]||(e[15]=[n("Category URL Slug",-1)])]),_:1}),o("div",de,[e[16]||(e[16]=o("span",{class:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-input bg-muted text-sm text-muted-foreground"}," /categories/ ",-1)),a(t(S),{id:"slug",modelValue:t(s).slug,"onUpdate:modelValue":e[3]||(e[3]=l=>t(s).slug=l),placeholder:y(t(s).name)||"category-slug",class:"rounded-l-none"},null,8,["modelValue","placeholder"])]),o("p",ce," Preview: /categories/"+c(t(s).slug||y(t(s).name)||"category-slug"),1),t(s).errors.slug?(u(),C("p",ue,c(t(s).errors.slug),1)):p("",!0)]),o("div",me,[a(t(v),{for:"description"},{default:r(()=>[...e[17]||(e[17]=[n("Description",-1)])]),_:1}),A(o("textarea",{id:"description","onUpdate:modelValue":e[4]||(e[4]=l=>t(s).description=l),placeholder:"Describe this category and what products it contains...",rows:"4",maxlength:"500",class:"flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[M,t(s).description]]),o("p",ge,c(t(s).description.length)+"/500 characters ",1)])]),_:1})]),_:1})]),o("div",fe,[a(t(g),null,{default:r(()=>[a(t(b),null,{default:r(()=>[a(t(_),null,{default:r(()=>[...e[18]||(e[18]=[n("Publishing",-1)])]),_:1})]),_:1}),a(t(f),{class:"space-y-4"},{default:r(()=>[o("div",pe,[o("input",{type:"checkbox",checked:t(s).is_active,onChange:e[5]||(e[5]=l=>{t(s).is_active=l.target.checked,console.log("Checkbox changed to:",l.target.checked,"Form is_active now:",t(s).is_active)}),id:"is_active",class:"rounded border-border"},null,40,ve),a(t(v),{for:"is_active",class:"cursor-pointer"},{default:r(()=>[...e[19]||(e[19]=[n(" Active (Visible to customers) ",-1)])]),_:1})]),t(s).is_active?p("",!0):(u(),C("div",ye,[o("div",xe,[a(t(D),{class:"h-4 w-4 text-orange-600 mt-0.5"}),e[20]||(e[20]=o("div",{class:"text-sm text-orange-700"},[o("p",{class:"font-medium"},"Draft Mode"),o("p",{class:"text-xs"},"This category will not be visible to customers")],-1))])]))]),_:1})]),_:1}),a(t(g),null,{default:r(()=>[a(t(b),null,{default:r(()=>[a(t(_),null,{default:r(()=>[...e[21]||(e[21]=[n("Organization",-1)])]),_:1})]),_:1}),a(t(f),{class:"space-y-4"},{default:r(()=>[o("div",be,[a(t(v),{for:"sort_order"},{default:r(()=>[...e[22]||(e[22]=[n("Sort Order",-1)])]),_:1}),a(t(S),{id:"sort_order",modelValue:t(s).sort_order,"onUpdate:modelValue":e[6]||(e[6]=l=>t(s).sort_order=l),type:"number",min:"0",placeholder:"0"},null,8,["modelValue"]),e[23]||(e[23]=o("p",{class:"text-xs text-muted-foreground"}," Lower numbers appear first in category listings ",-1))])]),_:1})]),_:1}),a(t(g),null,{default:r(()=>[a(t(b),null,{default:r(()=>[a(t(_),{class:"text-lg"},{default:r(()=>[...e[24]||(e[24]=[n("Category Stats",-1)])]),_:1})]),_:1}),a(t(f),{class:"space-y-3"},{default:r(()=>[o("div",_e,[o("div",he,[e[25]||(e[25]=o("span",{class:"text-muted-foreground"},"Products:",-1)),o("span",we,c(i.category.products_count||0),1)]),o("div",ke,[e[26]||(e[26]=o("span",{class:"text-muted-foreground"},"Created:",-1)),o("span",null,c(new Date(i.category.created_at).toLocaleDateString()),1)]),o("div",Ce,[e[27]||(e[27]=o("span",{class:"text-muted-foreground"},"Updated:",-1)),o("span",null,c(new Date(i.category.updated_at).toLocaleDateString()),1)]),o("div",Se,[e[28]||(e[28]=o("span",{class:"text-muted-foreground"},"Status:",-1)),o("span",{class:U(i.category.is_active?"text-green-600":"text-red-600")},c(i.category.is_active?"Active":"Inactive"),3)])]),a(t(z)),o("div",De,[a(t(m),{variant:"outline",size:"sm",class:"w-full",as:"a",href:`/products?category=${i.category.slug}`,target:"_blank"},{default:r(()=>[a(t(T),{class:"h-4 w-4 mr-2"}),e[29]||(e[29]=n(" View Category Page ",-1))]),_:1},8,["href"])])]),_:1})]),_:1})])])])])]),_:1},8,["breadcrumbs"]))}});export{Ye as default};
