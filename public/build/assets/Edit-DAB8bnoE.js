import{d as S,j as C,r as y,c as V,w as T,a as v,b as o,e as s,g as l,u as t,k as M,y as q,i as b,h as k,f as c,n as H,t as x,o as f}from"./app-DwIQyjG_.js";import{_ as I}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Blnrj5zo.js";import{_ as L}from"./PageHeader.vue_vue_type_script_setup_true_lang-P8uH2tsu.js";import{_ as O,a as Y,b as G,c as J}from"./VariantMatrix.vue_vue_type_script_setup_true_lang-57riwg76.js";import{_ as p,a as h}from"./CardContent.vue_vue_type_script_setup_true_lang-B84JJ7oU.js";import{a as g,_}from"./CardTitle.vue_vue_type_script_setup_true_lang-DZ8TnfwM.js";import{_ as z}from"./index-B8m1Vjhc.js";import{_ as P}from"./index-DryFPPhI.js";import{A as K}from"./arrow-left-BjG4jkNw.js";import{E as Q}from"./eye-DmRmXRSy.js";import{P as R}from"./package-BPOvwCiP.js";import"./Input.vue_vue_type_script_setup_true_lang-BuDybEju.js";import"./Separator.vue_vue_type_script_setup_true_lang--anB_U2L.js";import"./heart-BkN90LQn.js";import"./chevron-down-CCUGKcmt.js";import"./search-OrZvG4Gk.js";import"./house-CH9vzE5J.js";import"./chevron-right-CniR4j3X.js";import"./Label.vue_vue_type_script_setup_true_lang-D2D8q8NK.js";import"./useForwardExpose-BCzaoVI5.js";import"./plus-BTEqpmJB.js";import"./trash-2-CTAYMFdI.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-PVBsZ5Ap.js";import"./createContext-kUnmDYnW.js";import"./eye-off-DLgzL9xz.js";import"./refresh-cw-6AKb5P5V.js";const W={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},X={class:"flex items-center justify-between"},Z={class:"flex items-center gap-2 mt-2"},ee={key:0,class:"shrink-0"},te=["src","alt"],ae={class:"text-sm text-muted-foreground"},ie={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},se={class:"text-sm text-muted-foreground"},oe={class:"text-sm text-muted-foreground"},ne={class:"flex justify-between items-center pt-6"},le={class:"flex space-x-4"},re={key:0,class:"flex items-center"},ce={key:1},Se=S({__name:"Edit",props:{product:{type:Object,required:!0},categories:{type:Array,required:!0},existingVariants:{type:Array,default:()=>[]}},setup(n){const a=C({name:n.product.name,description:n.product.description,price:n.product.price,stock:n.product.stock,category_id:n.product.category_id,is_active:n.product.is_active,is_donatable:n.product.is_donatable,image:null,colors:[],sizes:[],variants:[]}),d=y(n.product.available_colors||[]),u=y(n.product.available_sizes||[]),m=y(n.existingVariants.map(i=>({id:i.id,color_id:i.color_id,size_id:i.size_id,color_name:i.color?.name||"Unknown",color_hex:i.color?.hex_code||"#000000",size_name:i.size?.name||"Unknown",stock:i.stock,price_adjustment:i.price_adjustment,is_active:i.is_active,sku:i.sku}))),E=V(()=>m.value.length>0),$=V(()=>n.existingVariants.length>0),U=[{label:"Back to Products",href:"/admin/products",icon:K,variant:"outline"},{label:"View Product",href:`/products/${n.product.slug}`,icon:Q,variant:"outline"}];T([d,u],()=>{d.value.length>0&&u.value.length>0&&A()},{deep:!0});const A=()=>{const i=[];d.value.forEach(e=>{u.value.forEach(r=>{m.value.find(w=>w.color_id===e.id&&w.size_id===r.id)||i.push({color_id:e.id,size_id:r.id,color_name:e.name,color_hex:e.hex_code||e.hex,size_name:r.name,stock:0,price_adjustment:0,is_active:!0})})}),m.value=[...m.value,...i],m.value=m.value.filter(e=>d.value.some(r=>r.id===e.color_id)&&u.value.some(r=>r.id===e.size_id))},j=i=>{d.value=i,a.colors=i},B=i=>{u.value=i,a.sizes=i},N=i=>{m.value=i,a.variants=i},F=()=>{console.log("Form data before submit:",{name:a.name,price:a.price,stock:a.stock,category_id:a.category_id,is_active:a.is_active,is_donatable:a.is_donatable});const i={_method:"PATCH",name:a.name||"",description:a.description||"",price:a.price||0,stock:a.stock||0,category_id:a.category_id||"",is_active:a.is_active?1:0,is_donatable:a.is_donatable?1:0,variants:a.variants||[],colors:a.colors||[],sizes:a.sizes||[]};a.image&&(i.image=a.image),C(i).post(`/admin/products/${n.product.id}`,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{console.log("Update successful")},onError:r=>{console.log("Update errors:",r)}})},D=()=>{confirm("Are you sure you want to delete this product? This action cannot be undone.")&&a.delete(`/admin/products/${n.product.id}`)};return(i,e)=>(f(),v(I,{title:"Edit Product"},{default:o(()=>[s(t(M),{title:`Edit ${n.product.name}`},null,8,["title"]),s(L,{title:`Edit Product: ${n.product.name}`,description:"Update product information and manage variants",icon:t(R),"icon-color":"text-blue-600",actions:U},null,8,["title","icon"]),l("div",W,[l("form",{onSubmit:q(F,["prevent"]),class:"space-y-8"},[s(t(p),null,{default:o(()=>[s(t(g),null,{default:o(()=>[l("div",X,[l("div",null,[s(t(_),null,{default:o(()=>[...e[1]||(e[1]=[c("Basic Product Information",-1)])]),_:1}),l("div",Z,[s(t(P),{class:H(n.product.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},{default:o(()=>[c(x(n.product.is_active?"Active":"Inactive"),1)]),_:1},8,["class"]),n.product.is_donatable?(f(),v(t(P),{key:0,class:"bg-blue-100 text-blue-800"},{default:o(()=>[...e[2]||(e[2]=[c(" Donatable ",-1)])]),_:1})):b("",!0)])]),n.product.image?(f(),k("div",ee,[l("img",{src:n.product.image,alt:n.product.name,class:"w-20 h-20 object-cover rounded-lg border"},null,8,te)])):b("",!0)])]),_:1}),s(t(h),null,{default:o(()=>[s(O,{form:t(a),categories:n.categories},null,8,["form","categories"])]),_:1})]),_:1}),$.value?(f(),v(t(p),{key:0},{default:o(()=>[s(t(g),null,{default:o(()=>[s(t(_),null,{default:o(()=>[...e[3]||(e[3]=[c("Current Variants",-1)])]),_:1}),l("p",ae," This product has "+x(n.existingVariants.length)+" existing variants. You can modify them below or add new color/size combinations. ",1)]),_:1})]),_:1})):b("",!0),l("div",ie,[s(t(p),null,{default:o(()=>[s(t(g),null,{default:o(()=>[s(t(_),null,{default:o(()=>[...e[4]||(e[4]=[c("Colors",-1)])]),_:1}),l("p",se,x(d.value.length>0?`${d.value.length} colors selected`:"No colors selected"),1)]),_:1}),s(t(h),null,{default:o(()=>[s(Y,{colors:d.value,"onUpdate:colors":j},null,8,["colors"])]),_:1})]),_:1}),s(t(p),null,{default:o(()=>[s(t(g),null,{default:o(()=>[s(t(_),null,{default:o(()=>[...e[5]||(e[5]=[c("Sizes",-1)])]),_:1}),l("p",oe,x(u.value.length>0?`${u.value.length} sizes selected`:"No sizes selected"),1)]),_:1}),s(t(h),null,{default:o(()=>[s(G,{sizes:u.value,"onUpdate:sizes":B},null,8,["sizes"])]),_:1})]),_:1})]),E.value||$.value?(f(),v(t(p),{key:1},{default:o(()=>[s(t(g),null,{default:o(()=>[s(t(_),null,{default:o(()=>[...e[6]||(e[6]=[c("Product Variants Management",-1)])]),_:1}),e[7]||(e[7]=l("p",{class:"text-sm text-muted-foreground"}," Configure stock, pricing, and availability for each variant ",-1))]),_:1}),s(t(h),null,{default:o(()=>[s(J,{variants:m.value,"base-price":t(a).price,"onUpdate:variants":N},null,8,["variants","base-price"])]),_:1})]),_:1})):b("",!0),l("div",ne,[s(t(z),{type:"button",variant:"destructive",onClick:D,disabled:t(a).processing},{default:o(()=>[...e[8]||(e[8]=[c(" Delete Product ",-1)])]),_:1},8,["disabled"]),l("div",le,[s(t(z),{type:"button",variant:"outline",disabled:t(a).processing,onClick:e[0]||(e[0]=r=>i.$inertia.visit("/admin/products"))},{default:o(()=>[...e[9]||(e[9]=[c(" Cancel ",-1)])]),_:1},8,["disabled"]),s(t(z),{type:"submit",disabled:t(a).processing,class:"min-w-[120px]"},{default:o(()=>[t(a).processing?(f(),k("div",re,[...e[10]||(e[10]=[l("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),c(" Updating... ",-1)])])):(f(),k("span",ce,"Update Product"))]),_:1},8,["disabled"])])])],32)])]),_:1}))}});export{Se as default};
