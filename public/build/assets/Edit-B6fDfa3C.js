import{d as S,j as V,r as y,c as C,w as T,a as g,b as o,e as s,g as r,u as t,k as M,y as q,i as b,h as k,f as d,t as x,o as f}from"./app-BIsdkUFR.js";import{_ as H}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Cw0dUj-z.js";import{_ as I}from"./PageHeader.vue_vue_type_script_setup_true_lang-oeEeif41.js";import{_ as L,a as O,b as Y,c as G}from"./VariantMatrix.vue_vue_type_script_setup_true_lang-DJmDDN4e.js";import{_ as p,a as h,b as z}from"./index-1wb7NqwU.js";import{a as _,_ as v}from"./CardTitle.vue_vue_type_script_setup_true_lang-BbzwQhHq.js";import{_ as P}from"./index-BCDJER87.js";import{A as J}from"./arrow-left-CucpjXOn.js";import{E as K}from"./eye-dsrP_Bt2.js";import{P as Q}from"./package-DtQNl1ka.js";import"./Input.vue_vue_type_script_setup_true_lang-2lXwBhL7.js";import"./Separator.vue_vue_type_script_setup_true_lang-BCygaSuc.js";import"./heart-Zb1J_MV3.js";import"./chevron-down-DVfPXNKi.js";import"./search-B8PsoUUd.js";import"./house-DH-e972f.js";import"./chevron-right-ChP98AYB.js";import"./Label.vue_vue_type_script_setup_true_lang-6xkc7M51.js";import"./useForwardExpose-DfRgSPHl.js";import"./plus-0o7YzSEe.js";import"./trash-2-BxbA_I0U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-Dj2zzMR7.js";import"./createContext-Cq00W1KP.js";import"./eye-off-CucNHYsb.js";import"./refresh-cw-YHcqqrc4.js";const R={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},W={class:"flex items-center justify-between"},X={class:"flex items-center gap-2 mt-2"},Z={key:0,class:"shrink-0"},ee=["src","alt"],te={class:"text-sm text-muted-foreground"},ae={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ie={class:"text-sm text-muted-foreground"},se={class:"text-sm text-muted-foreground"},oe={class:"flex justify-between items-center pt-6"},ne={class:"flex space-x-4"},re={key:0,class:"flex items-center"},le={key:1},Fe=S({__name:"Edit",props:{product:{type:Object,required:!0},categories:{type:Array,required:!0},existingVariants:{type:Array,default:()=>[]}},setup(n){const a=V({name:n.product.name,description:n.product.description,price:n.product.price,stock:n.product.stock,category_id:n.product.category_id,is_active:n.product.is_active,is_donatable:n.product.is_donatable,image:null,colors:[],sizes:[],variants:[]}),c=y(n.product.available_colors||[]),u=y(n.product.available_sizes||[]),m=y(n.existingVariants.map(i=>({id:i.id,color_id:i.color_id,size_id:i.size_id,color_name:i.color?.name||"Unknown",color_hex:i.color?.hex_code||"#000000",size_name:i.size?.name||"Unknown",stock:i.stock,price_adjustment:i.price_adjustment,is_active:i.is_active,sku:i.sku}))),E=C(()=>m.value.length>0),$=C(()=>n.existingVariants.length>0),U=[{label:"Back to Products",href:"/admin/products",icon:J,variant:"outline"},{label:"View Product",href:`/products/${n.product.slug}`,icon:K,variant:"outline"}];T([c,u],()=>{c.value.length>0&&u.value.length>0&&A()},{deep:!0});const A=()=>{const i=[];c.value.forEach(e=>{u.value.forEach(l=>{m.value.find(w=>w.color_id===e.id&&w.size_id===l.id)||i.push({color_id:e.id,size_id:l.id,color_name:e.name,color_hex:e.hex_code||e.hex,size_name:l.name,stock:0,price_adjustment:0,is_active:!0})})}),m.value=[...m.value,...i],m.value=m.value.filter(e=>c.value.some(l=>l.id===e.color_id)&&u.value.some(l=>l.id===e.size_id))},j=i=>{c.value=i,a.colors=i},B=i=>{u.value=i,a.sizes=i},N=i=>{m.value=i,a.variants=i},F=()=>{console.log("Form data before submit:",{name:a.name,price:a.price,stock:a.stock,category_id:a.category_id,is_active:a.is_active,is_donatable:a.is_donatable});const i={_method:"PATCH",name:a.name||"",description:a.description||"",price:a.price||0,stock:a.stock||0,category_id:a.category_id||"",is_active:a.is_active?1:0,is_donatable:a.is_donatable?1:0,variants:a.variants||[],colors:a.colors||[],sizes:a.sizes||[]};a.image&&(i.image=a.image),V(i).post(`/admin/products/${n.product.id}`,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{console.log("Update successful")},onError:l=>{console.log("Update errors:",l)}})},D=()=>{confirm("Are you sure you want to delete this product? This action cannot be undone.")&&a.delete(`/admin/products/${n.product.id}`)};return(i,e)=>(f(),g(H,{title:"Edit Product"},{default:o(()=>[s(t(M),{title:`Edit ${n.product.name}`},null,8,["title"]),s(I,{title:`Edit Product: ${n.product.name}`,description:"Update product information and manage variants",icon:t(Q),"icon-color":"text-primary",actions:U},null,8,["title","icon"]),r("div",R,[r("form",{onSubmit:q(F,["prevent"]),class:"space-y-8"},[s(t(p),null,{default:o(()=>[s(t(_),null,{default:o(()=>[r("div",W,[r("div",null,[s(t(v),null,{default:o(()=>[...e[1]||(e[1]=[d("Basic Product Information",-1)])]),_:1}),r("div",X,[s(t(P),{variant:n.product.is_active?"secondary":"destructive"},{default:o(()=>[d(x(n.product.is_active?"Active":"Inactive"),1)]),_:1},8,["variant"]),n.product.is_donatable?(f(),g(t(P),{key:0,variant:"primary"},{default:o(()=>[...e[2]||(e[2]=[d(" Donatable ",-1)])]),_:1})):b("",!0)])]),n.product.image?(f(),k("div",Z,[r("img",{src:n.product.image,alt:n.product.name,class:"w-20 h-20 object-cover rounded-lg border"},null,8,ee)])):b("",!0)])]),_:1}),s(t(h),null,{default:o(()=>[s(L,{form:t(a),categories:n.categories},null,8,["form","categories"])]),_:1})]),_:1}),$.value?(f(),g(t(p),{key:0},{default:o(()=>[s(t(_),null,{default:o(()=>[s(t(v),null,{default:o(()=>[...e[3]||(e[3]=[d("Current Variants",-1)])]),_:1}),r("p",te," This product has "+x(n.existingVariants.length)+" existing variants. You can modify them below or add new color/size combinations. ",1)]),_:1})]),_:1})):b("",!0),r("div",ae,[s(t(p),null,{default:o(()=>[s(t(_),null,{default:o(()=>[s(t(v),null,{default:o(()=>[...e[4]||(e[4]=[d("Colors",-1)])]),_:1}),r("p",ie,x(c.value.length>0?`${c.value.length} colors selected`:"No colors selected"),1)]),_:1}),s(t(h),null,{default:o(()=>[s(O,{colors:c.value,"onUpdate:colors":j},null,8,["colors"])]),_:1})]),_:1}),s(t(p),null,{default:o(()=>[s(t(_),null,{default:o(()=>[s(t(v),null,{default:o(()=>[...e[5]||(e[5]=[d("Sizes",-1)])]),_:1}),r("p",se,x(u.value.length>0?`${u.value.length} sizes selected`:"No sizes selected"),1)]),_:1}),s(t(h),null,{default:o(()=>[s(Y,{sizes:u.value,"onUpdate:sizes":B},null,8,["sizes"])]),_:1})]),_:1})]),E.value||$.value?(f(),g(t(p),{key:1},{default:o(()=>[s(t(_),null,{default:o(()=>[s(t(v),null,{default:o(()=>[...e[6]||(e[6]=[d("Product Variants Management",-1)])]),_:1}),e[7]||(e[7]=r("p",{class:"text-sm text-muted-foreground"}," Configure stock, pricing, and availability for each variant ",-1))]),_:1}),s(t(h),null,{default:o(()=>[s(G,{variants:m.value,"base-price":t(a).price,"onUpdate:variants":N},null,8,["variants","base-price"])]),_:1})]),_:1})):b("",!0),r("div",oe,[s(t(z),{type:"button",variant:"destructive",onClick:D,disabled:t(a).processing},{default:o(()=>[...e[8]||(e[8]=[d(" Delete Product ",-1)])]),_:1},8,["disabled"]),r("div",ne,[s(t(z),{type:"button",variant:"outline",disabled:t(a).processing,onClick:e[0]||(e[0]=l=>i.$inertia.visit("/admin/products"))},{default:o(()=>[...e[9]||(e[9]=[d(" Cancel ",-1)])]),_:1},8,["disabled"]),s(t(z),{type:"submit",disabled:t(a).processing,class:"min-w-[120px]"},{default:o(()=>[t(a).processing?(f(),k("div",re,[...e[10]||(e[10]=[r("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),d(" Updating... ",-1)])])):(f(),k("span",le,"Update Product"))]),_:1},8,["disabled"])])])],32)])]),_:1}))}});export{Fe as default};
